---
title: Vim快捷键总结
date: 2019-09-28 11:42:13
tags:
---

Vim快捷键总结
<!-- more -->

## 常用模式

> 普通模式(Normal mode)

在普通模式中，可以使用快捷键命令，或按:输入命令行，比如移动光标，删除文本等等。这也是Vim启动后的默认模式。
> 插入模式(Insert mode)

在这个模式中，大多数按键都会向文本缓冲中插入文本。大多数新用户希望文本编辑器编辑过程中一直保持这个模式。可以输入文本，在正常模式下，按i、a、o等都可以进入插入模式。

> 可视模式(Visual Mode)

正常模式下按v可以进入可视模式， 在可视模式下，移动光标可以选择文本。按V进入可视行模式， 总是整行整行的选中。ctrl+v进入可视块模式。

> 命令行模式(Command line mode)

在命令行模式中可以输入会被解释成并执行的文本。例如执行命令（:键），搜索（/和?键）或者过滤命令（!键）。在命令执行之后，Vim返回到命令行模式之前的模式，通常是普通模式。

> Ex模式(Ex Mode)

多行的Command-Line模式,普通模式下按Q进入Ex模式。

> 选择模式(Select Mode)

在gvim下常用的模式，用鼠标拖选区域的时候，就进入了选择模式。和可视模式不同的是，在这个模式下，选择完了高亮区域后，敲任何按键就直接输入并替换选择的文本了。普通模式下，可以按gh进入。

## 基本插入

| 快捷键 | 说明 |
| :-: | :-: |
|i|在光标前插入|
|I|跳到当前行句首进入输入模式|
|a|在光标后插入|
|A|跳到当前行句尾进入输入模式|
|o|跳到下一行并创建新的一行进入输入模式(常用)|
|O|跳到上一行并创建新的一行进入输入模式|
|r|进入取代模式一次，替换后进入移动模式|
|R|进入取代模式，直到按Esc后退出进入移动模式|
|:r filename|在当前位置插入另一个文件的内容|
|:[n]r filename|在第n行插入另一个文件的内容|
|:r !date |在光标处插入当前日期与时间。同理，:r !command可以将其它shell命令的输出插入当前文档|

tips:按8，再按i，进入插入模式，输入=， 按esc进入命令模式，就会出现8个=。 这在插入分割线时非常有用，如30i+<esc>就插入了30个+组成的分割线

## 改写插入
| 快捷键 | 说明 |
| :-: | :-: |
|c[n]w|改写光标后1(n)个词|
|c[n]l| 改写光标后n个字母|
|c[n]h| 改写光标前n个字母|
|[n]cc| 修改当前[n]行|
|[n]s| 以输入的文本替代光标之后1(n)个字符，相当于c[n]l|
|[n]S| 删除指定数目的行，并以所输入文本代替之|

## 文档操作

| 快捷键 | 说明 |
| :- | :- | 
|:e file |关闭当前编辑的文件，并开启新的文件。 如果对当前文件的修改未保存，vi会警告。 |
|:e! file |放弃对当前文件的修改，编辑新的文件。                                       |
|:e+file | 开始新的文件，并从文件尾开始编辑。                                         |
|:e+n file | 开始新的文件，并从第n行开始编辑。                                        |
|:enew |编译一个未命名的新文档。(CTRL-W n)                                            |
|:e |  重新加载当前文档                                       |
|:e! | 重新加载当前文档，并丢弃已做的改动。                                           |
|:e#或ctrl+^ | 回到刚才编辑的文件，很实用。                                           |
|:f或ctrl+g | 显示文档名，是否修改，和光标位置。                                      |
|:f filename | 改变编辑的文件名，这时再保存相当于另存为。                             |
|gf | 打开以光标所在字符串为文件名的文件。                                            |
|:w | 保存修改。                                                                      |
|:n1,n2w filename | 选择性保存从某n1行到另n2行的内容。|
|:wq | 保存并退出|
|ZZ | 保存并退出|
|:x | 保存并退出|
|:q[uit] |退出当前窗口。(CTRL-W q或CTRL-W CTRL-Q)|
|:saveas newfilename | 另存为|
|:browse e | 会打开一个文件浏览器让你选择要编辑的文件。 如果是终端中，则会打开netrw的文件浏览窗口； 如果是gvim，则会打开一个图形界面的浏览窗口。 实际上:browse后可以跟任何编辑文档的命令，如sp等。 用browse打开的起始目录可以由browsedir来设置：|
|:set browsedir=last | 用上次访问过的目录（默认）； |
|:set browsedir=buffer | 用当前文件所在目录；       |
|:set browsedir=current | 用当前工作目录；          |
|:Sex | 水平分割一个窗口，浏览文件系统；            |
|:Vex | 垂直分割一个窗口，浏览文件系统；            |

## 光标移动
- 基本移动

以下移动都是在normal模式下

| 快捷键 | 说明 |
| :-: | :-: |     
|h或退格| 左移一个字符；                                 |
|l或空格| 右移一个字符；                                 |
|j| 下移一行；                                           |
|k| 上移一行；
|gj| 移动到一段内的下一行；|
|gk| 移动到一段内的上一行；|
|+或Enter| 把光标移至下一行第一个非空白字符。
|-| 把光标移至上一行第一个非空白字符。|
|w| 前移一个单词，光标停在下一个单词开头；|
|W| 移动下一个单词开头，但忽略一些标点；|
|e| 前移一个单词，光标停在下一个单词末尾；|
|E| 移动到下一个单词末尾，如果词尾有标点，则移动到标点；|
|b| 后移一个单词，光标停在上一个单词开头；|
|B| 移动到上一个单词开头，忽略一些标点；|
|ge| 后移一个单词，光标停在上一个单词末尾；|
|gE| 同 ge ，不过‘单词’包含单词相邻的标点。|
|(| 前移1句。                              |
|)| 后移1句。                              |
|{| 前移1段。                              |
|}| 后移1段。                              |
|fc| 把光标移到同一行的下一个c字符处|
|Fc| 把光标移到同一行的上一个c字符处|
|tc| 把光标移到同一行的下一个c字符前|
|Tc| 把光标移到同一行的上一个c字符后|
|;| 配合f & t使用，重复一次|
|,| 配合f & t使用，反向重复一次|

上面的操作都可以配合n使用，比如在正常模式(下面会讲到)下输入3h， 则光标向左移动3个字符

| 快捷键 | 说明 |
|:-:|:-|
|0| 移动到行首。|
|\|| 移动到行首。|
|g0| 移到光标所在屏幕行行首。|
|^| 移动到本行第一个非空白字符。|
|g^| 同 ^ ，但是移动到当前屏幕行第一个非空字符处。|
|n\|| 把光标移到第n列上。|
|nG| 到文件第n行。|
|H| 把光标移到屏幕最顶端一行。|
|M| 把光标移到屏幕中间一行。|
|L| 把光标移到屏幕最底端一行。 |
|gg| 到文件头部。              |
|G| 到文件尾部。               |

- 翻屏

| 快捷键 | 说明 |
|:-:|:-|
|ctrl+f| 下翻一屏。          |
|ctrl+b| 上翻一屏。          |
|ctrl+d| 下翻半屏。           |
|ctrl+u| 上翻半屏。     |
|ctrl+e| 向下滚动一行。 |
|ctrl+y| 向上滚动一行。 |
|n%| 到文件n%的位置。   |
|zz| 将当前行移动到屏幕中央。|
|zt| 将当前行移动到屏幕顶端。|
|zb| 将当前行移动到屏幕底端。|

- 标记

使用标记可以快速移动。到达标记后，可以用Ctrl+o返回原来的位置。 Ctrl+o和Ctrl+i 很像浏览器上的 后退 和 前进 。

| 快捷键 | 说明 |
| :-| :- |
|m{a-z}| 标记光标所在位置，局部标记，只用于当前文件。|
|m{A-Z}| 标记光标所在位置，全局标记。标记之后，退出Vim， 重新启动，标记仍然有效。|
|`{a-z}| 移动到标记位置。|
|'{a-z}| 移动到标记行的行首。|
|`{0-9}|回到上[2-10]次关闭vim时最后离开的位置。|
|\`\`| 移动到上次编辑的位置。"也可以，不过\`\`精确到列，而"精确到行 。如果想跳转到更老的位置，可以按Ctrl+o，跳转到更新的位置用Ctrl+i。|
|`"| 移动到上次离开的地方。|
|`.| 移动到最后改动的地方。|
|:marks |显示所有标记。|
|:delmarks a b | 删除标记a和b。|
|:delmarks a-c | 删除标记a、b和c。|
|:delmarks a c-f | 删除标记a、c、d、e、f。|
|:delmarks! | 删除当前缓冲区的所有标记。|
|:help mark-motions |查看更多关于mark的知识。|

## 剪切复制和寄存器

- 剪切和复制、粘贴

| 快捷键 | 说明 |
| :-| :- |
|[n]x| 剪切光标右边n个字符，相当于d[n]l。|
|[n]X| 剪切光标左边n个字符，相当于d[n]h。|
|y| 复制在可视模式下选中的文本。|
|yy or Y| 复制整行文本。|
|y[n]w| 复制一(n)个词。|
|y[n]l| 复制光标右边1(n)个字符。|
|y[n]h| 复制光标左边1(n)个字符。|
|y| 从光标当前位置复制到行尾。|
|y0| 从光标当前位置复制到行首。|
|m,ny<cr>| 复制m行到n行的内容。|
|y1G或ygg| 复制光标以上的所有行。|
|yG| 复制光标以下的所有行。|
|yaw和yas|复制一个词和复制一个句子，即使光标不在词首和句首也没关系。|
|d| 删除（剪切）在可视模式下选中的文本。|
|d or D| 删除（剪切）当前位置到行尾的内容。|
|d[n]w| 删除（剪切）1(n)个单词|
|d[n]l| 删除（剪切）光标右边1(n)个字符。|
|d[n]h| 删除（剪切）光标左边1(n)个字符。|
|d0|删除（剪切）当前位置到行首的内容|
|[n] dd|删除（剪切）1(n)行。|
|m,nd<cr\>| 剪切m行到n行的内容。|
|d1G或dgg| 剪切光标以上的所有行。|
|dG|剪切光标以下的所有行。|
|daw和das|剪切一个词和剪切一个句子，即使光标不在词首和句首也没关系。|
|d/f<cr\>|这是一个比较高级的组合命令，它将删除当前位置 到下一个f之间的内容。|
|p| 在光标之后粘贴。|
|P| 在光标之前粘贴。|

- 文本对象

| 快捷键 | 说明 |
| :-| :- |
|aw|一个词|
|as|一句。|
|ap|一段。|
|ab|一块（包含在圆括号中的）。|

y, d, c, v都可以跟文本对象。

- 寄存器

| 快捷键 | 说明 |
| :-| :- |
|a-z|都可以用作寄存器名。”ayy把当前行的内容放入a寄存器。|
|A-Z|用大写字母索引寄存器，可以在寄存器中追加内容。 如”Ayy把当前行的内容追加到a寄存器中。|
|:reg |显示所有寄存器的内容。|
|“”|不加寄存器索引时，默认使用的寄存器。|
|“*|当前选择缓冲区，”*yy把当前行的内容放入当前选择缓冲区。|
|“+|系统剪贴板。”+yy把当前行的内容放入系统剪贴板。|


### 常用操作

> vim中清空文件内容

```
命令为：ggdG
其中，gg为跳转到文件首行；dG为删除光标所在行以及其下所有行的内容；
再细讲，d为删除，G为跳转到文件末尾行
```

> vim中格式化json

```
:%!python -m json.tool

参考：https://blog.csdn.net/qianye2015/article/details/48824981

但是如果包含中文，会将中文转换成Unicode，需要执行如下命令

:%!python -m json.tool
:%!python -c "import re,sys;sys.stdout.write(re.sub(r'\\\u[0-9a-f]{4}', lambda m:m.group().decode('unicode_escape').encode('utf-8'), sys.stdin.read()))"

但是内容太长记不住，可以编辑.vimrc
➜  ~ cat ~/.vimrc
set nu
colorscheme darkblue
syntax on
set backspace=2
 command! JsonFormat :execute '%!python -m json.tool'
  \ | :execute '%!python -c "import re,sys;sys.stdout.write(re.sub(r\"\\\u[0-9a-f]{4}\", lambda m:m.group().decode(\"unicode_escape\").encode(\"utf-8\"), sys.stdin.read()))"'
如此，执行:JsonFormat即可
```

> vim中移动代码块

```
（1）选定文本块，使用v进入可视模式；移动光标键选定内容
（2）复制选定块到缓冲区，用y；复制整行，用yy
（3）剪切选定块到缓冲区，用d；剪切整行用dd
（4）粘贴缓冲区中的内容，用p
```
